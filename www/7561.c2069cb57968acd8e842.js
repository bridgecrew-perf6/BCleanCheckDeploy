(self.webpackChunkBCleanCheck=self.webpackChunkBCleanCheck||[]).push([[7561],{7561:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ReportTimeTrackingPageModule:()=>p});var o=i(8583),n=i(665),a=i(2859),r=i(5496),s=i(4762),c=i(9786),l=i(3018),d=i(245),g=i(5001),h=i(7053);const m=function(){return["/manager"]},u=[{path:"",component:(()=>{class e{constructor(e,t,i,o,n,a,r){this.data=e,this.loadingCtrl=t,this.route=i,this.lanServ=o,this.toastCtrl=n,this.authService=a,this.navCtrl=r,this.timeList=[],this.formatTime=[],this.tTrackingRep="",this.exportTo="",this.refTimeIn=0,this.refTimeEnd=0,this.excelIconDisable=!0,this.langu="",this.userLanguage()}ngOnInit(){}userLanguage(){this.authService.userDetails().forEach(e=>{c.Z.firestore().collection("userLanguage").doc(e.uid).get().then(e=>{this.getUserLanguage(e.data().language)})})}Logout(){this.authService.logoutUser().then(()=>(0,s.__awaiter)(this,void 0,void 0,function*(){this.navCtrl.navigateBack("login"),(yield this.toastCtrl.create({message:"Logout successfull",duration:3e3})).present()})).catch(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e,duration:3e3})).present()}))}datePick1(e){this.excelIconDisable=null==this.myDate1||null==this.myDate2}datePick2(e){this.excelIconDisable=null==this.myDate1||null==this.myDate2}loadData(){return(0,s.__awaiter)(this,void 0,void 0,function*(){let e=this.loadingCtrl.create({message:"Loading ..."});(yield e).present(),c.Z.firestore().collection("TimeEntry").get().then(t=>(0,s.__awaiter)(this,void 0,void 0,function*(){t.forEach(e=>{c.Z.firestore().collection("employee").where("Email","==",e.data().UserEmail).get().then(t=>(0,s.__awaiter)(this,void 0,void 0,function*(){t.forEach(t=>{this.timeList.push({Employee:t.data().Name,EmployeeLastName:t.data().LastName,EmployeeSecondLastName:t.data().SecondLastName,EmployeeEmail:e.data().UserEmail,Time:new Date(1e3*e.data().Time.seconds).toString(),TimeType:e.data().TimeType,Type:e.data().Type,Status:e.data().Status,ApprovedBy:e.data().ApprovedBy,UpdatedOn:new Date(1e3*e.data().updatedOn.seconds)})})})).catch(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e.message,duration:3e3})).present()}))}),(yield e).dismiss()})).catch(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e.message,duration:3e3})).present()}))})}exportToExcel(){this.data.exportToExcel(this.timeList,"TimeSheet")}getUserLanguage(e){switch(e){case"English":this.tTrackingRep="Time Control Report",this.exportTo="Export to Excel";break;case"Spanish":this.tTrackingRep="Reporte de Control de Tiempo",this.exportTo="Exportar a Excel"}}exportTimeTrackingToExcel(){this.data.exportToExcel(this.timeList,"TimeSheet")}method(){this.formatDateTime()}getDateTimeIn(e){return new Date(e).getTime()}getDateTimeOut(e){return new Date(e).getTime()}formatDateTime(){c.Z.firestore().collection("WorkTime").where("Status","==","Approved").get().then(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){e.forEach(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){e.data().TimeInRef>=this.getDateTimeIn(this.myDate1)&&e.data().TimeOutRef<=this.getDateTimeOut(this.myDate2)?c.Z.firestore().collection("employee").where("Email","==",e.data().UserEmail).get().then(t=>(0,s.__awaiter)(this,void 0,void 0,function*(){t.forEach(t=>{this.timeList.push({Employee:t.data().Name,EmployeeLastName:t.data().LastName,EmployeeSecondLastName:t.data().SecondLastName,EmployeeEmail:e.data().UserEmail,Date:e.data().Date,IN:e.data().TimeIn,OUT:e.data().TimeOut,Total:this.totalWorkedTime(e.data().TimeInRef,e.data().TimeOutRef,t.data().Email),ApprovedBy:e.data().ApprovedBy})})})).then(()=>(0,s.__awaiter)(this,void 0,void 0,function*(){this.data.exportToExcel(this.timeList,"TimeSheet")})).catch(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e.message,duration:3e3})).present()})):(yield this.toastCtrl.create({message:"There are no items within selected time range",duration:3e3})).present()}))})).then(()=>(0,s.__awaiter)(this,void 0,void 0,function*(){})).catch(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e.message,duration:3e3})).present()}))}getIN(e){var t="";c.Z.firestore().collection("TimeEntry").where("Time","==",e).where("TimeType","==","Work").where("Type","==","Start").get().then(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){e.forEach(e=>{var i=new Date(1e3*e.data().Time.seconds),o=i.getHours(),n=i.getMinutes(),a=i.getSeconds();t=o+":"+n+":"+a,this.refTimeIn=new Date(1e3*e.data().Time.seconds).getTime(),this.timeList.push(t)})}))}getEnd(e){var t="";c.Z.firestore().collection("TimeEntry").where("Time","==",e).where("TimeType","==","Work").where("Type","==","End").get().then(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){e.forEach(e=>{var i=new Date(1e3*e.data().Time.seconds),o=i.getHours(),n=i.getMinutes(),a=i.getSeconds();return t=o+":"+n+":"+a,this.refTimeEnd=new Date(1e3*e.data().Time.seconds).getTime(),t})}))}getBreakStart(e){c.Z.firestore().collection("TimeEntry").where("Time","==",e).where("TimeType","==","Break").where("Type","==","Start").get().then(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){e.forEach(e=>{var t=new Date(1e3*e.data().Time.seconds);return t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()})}))}getBreakEnd(e){c.Z.firestore().collection("TimeEntry").where("Time","==",e).where("TimeType","==","Break").where("Type","==","End").get().then(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){e.forEach(e=>{var t=new Date(1e3*e.data().Time.seconds);return t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()})}))}getInRefTime(e){c.Z.firestore().collection("TimeEntry").where("Time","==",e).where("TimeType","==","Work").where("Type","==","Start").get().then(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){e.forEach(e=>{var t=new Date(1e3*e.data().Time.seconds);return t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()})}))}getEndRefTime(e){c.Z.firestore().collection("TimeEntry").where("Time","==",e).where("TimeType","==","Work").where("Type","==","End").get().then(e=>(0,s.__awaiter)(this,void 0,void 0,function*(){e.forEach(e=>new Date(1e3*e.data().Time.seconds).getTime())}))}totalWorkedTime(e,t,i){var o=0;c.Z.firestore().collection("BreakTime").where("UserEmail","==",i).get().then(e=>{e.forEach(e=>{""!=e.data().TimeOutRef&&""!=e.data().TimeInRef&&(o=e.data().TimeOutRef-e.data().TimeInRef)})});var n=((t-e-o)/1e3).toFixed(0),a=Math.floor(Number(n)/60).toString();let r;return Number(a)>59&&(r=Math.floor(Number(a)/60),r=r>=10?r:"0"+r,a=(Number(a)-60*r).toString(),a=Number(a)>=10?a:"0"+a),n=Math.floor(Number(n)%60).toString(),r||(r="00"),a||(a="00"),(n=Number(n)>=10?n:"0"+n)||(n="00"),r+":"+a+":"+n}getWorkTimeTotal(){}getBreakTimeTotal(){}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(d.B),l.Y36(a.HT),l.Y36(r.F0),l.Y36(g.L),l.Y36(a.yF),l.Y36(h.$),l.Y36(a.SH))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-report-time-tracking"]],decls:27,vars:6,consts:[["color","danger"],[1,"lblHeading"],["slot","start"],["block","","clear","","color","Light","icon-only","",1,"backButton",3,"routerLink"],["name","arrow-back-outline",1,"backArrow"],["slot","end"],["icon-only","","clear","",1,"logoutBtn",3,"click"],["name","log-out",1,"lgIcon"],[1,"filterTitle"],[1,"titleLabel"],[1,"filterField"],[1,"fieldLabel"],["displayFormat","MMM DD, YYYY HH:mm","placeholder","Select Date 1",1,"dt",3,"ngModel","ngModelChange","ionChange"],["displayFormat","MMM DD, YYYY HH:mm","placeholder","Select Date 2",1,"dt",3,"ngModel","ngModelChange","ionChange"],[1,"filterBtn"],["src","../../assets/icon/microsoft-excel.ico",1,"imgC",3,"hidden","click"]],template:function(e,t){1&e&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar",0),l.TgZ(2,"ion-title"),l.TgZ(3,"small"),l.TgZ(4,"ion-label",1),l._uU(5),l.qZA(),l.qZA(),l.qZA(),l.TgZ(6,"ion-buttons",2),l.TgZ(7,"ion-button",3),l._UZ(8,"ion-icon",4),l.qZA(),l.qZA(),l.TgZ(9,"ion-buttons",5),l.TgZ(10,"ion-button",6),l.NdJ("click",function(){return t.Logout()}),l._UZ(11,"ion-icon",7),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(12,"ion-content"),l.TgZ(13,"ion-grid"),l.TgZ(14,"ion-row",8),l.TgZ(15,"ion-label",9),l._uU(16,"Filtered Report"),l.qZA(),l.qZA(),l.TgZ(17,"ion-row",10),l.TgZ(18,"ion-label",11),l._uU(19,"Start:"),l.qZA(),l.TgZ(20,"ion-datetime",12),l.NdJ("ngModelChange",function(e){return t.myDate1=e})("ionChange",function(e){return t.datePick1(e)}),l.qZA(),l.qZA(),l.TgZ(21,"ion-row",10),l.TgZ(22,"ion-label",11),l._uU(23,"End:"),l.qZA(),l.TgZ(24,"ion-datetime",13),l.NdJ("ngModelChange",function(e){return t.myDate2=e})("ionChange",function(e){return t.datePick2(e)}),l.qZA(),l.qZA(),l.TgZ(25,"ion-row",14),l.TgZ(26,"img",15),l.NdJ("click",function(){return t.method()}),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.xp6(5),l.Oqu(t.tTrackingRep),l.xp6(2),l.Q6J("routerLink",l.DdM(5,m)),l.xp6(13),l.Q6J("ngModel",t.myDate1),l.xp6(4),l.Q6J("ngModel",t.myDate2),l.xp6(2),l.Q6J("hidden",t.excelIconDisable))},directives:[a.Gu,a.sr,a.wd,a.Q$,a.Sm,a.YG,a.YI,r.rH,a.gu,a.W2,a.jY,a.Nd,a.x4,a.QI,n.JJ,n.On],styles:[".rowStyle[_ngcontent-%COMP%]{background-color:#fff;padding-left:30px;border-radius:30px;margin-top:10px}.rowStyle[_ngcontent-%COMP%], .rowStyle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}.rowStyle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-top:13px;font-size:64px;border:solid;background-color:#daa520;position:relative}.rowStyle[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}ion-content[_ngcontent-%COMP%]{--ion-background-color:#fff}.colStyle[_ngcontent-%COMP%]{align-items:center}.headerStyle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:0}.backArrow[_ngcontent-%COMP%]{color:#fff}ion-grid[_ngcontent-%COMP%]{--ion-grid-column-padding:10px;border-collapse:collapse;border-style:hidden}ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]:first-child{background-color:gray;font-weight:700}ion-grid[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{border:1px solid #000;border-bottom:0;border-right:0}ion-grid[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]:last-child{border-right:1px solid #000}ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]:last-child{border-bottom:1px solid #000}.lblHeading[_ngcontent-%COMP%]{color:#fff}.lbls[_ngcontent-%COMP%]{color:blue}.filterTitle[_ngcontent-%COMP%]{background-color:grey;text-align:center;color:#000;height:50px}.titleLabel[_ngcontent-%COMP%]{font-size:large;margin:auto}.filterField[_ngcontent-%COMP%]{background-color:blue;color:#faebd7;height:50px}.dt[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%]{font-size:large}.dt[_ngcontent-%COMP%]{margin:auto}.filterBtn[_ngcontent-%COMP%]{background-color:blue;height:100px}.imgC[_ngcontent-%COMP%]{font-size:large;margin:auto;height:50px;width:50px}"]}),e})()}];let T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[r.Bz.forChild(u)],r.Bz]}),e})(),p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[o.ez,n.u5,a.Pc,T]]}),e})()}}]);