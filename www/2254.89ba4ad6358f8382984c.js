(self.webpackChunkBCleanCheck=self.webpackChunkBCleanCheck||[]).push([[2254],{2254:(e,t,i)=>{"use strict";i.r(t),i.d(t,{FinalChecklistReportPageModule:()=>f});var n=i(8583),a=i(665),o=i(2859),s=i(5496),r=i(4762),c=i(9786),l=i(3018),h=i(245),g=i(5001),d=i(7053);const m=function(){return["/manager"]},u=[{path:"",component:(()=>{class e{constructor(e,t,i,n,a,o,s){this.data=e,this.toastCtrl=t,this.loadingCtrl=i,this.route=n,this.lanServ=a,this.authService=o,this.navCtrl=s,this.checkLists=[],this.checkListItems=[],this.items=[],this.exportTo="",this.refTimeIn=0,this.refTimeEnd=0,this.excelIconDisable=!0,this.langu="",this.usEmail="",this.empName="",this.itemsTemp=[],this.userLanguage()}userLanguage(){this.authService.userDetails().forEach(e=>{c.Z.firestore().collection("userLanguage").doc(e.uid).get().then(e=>{this.getUserLanguage(e.data().language)})})}getUserLanguage(e){}ngOnInit(){}Logout(){this.authService.logoutUser().then(()=>(0,r.__awaiter)(this,void 0,void 0,function*(){this.navCtrl.navigateBack("login"),(yield this.toastCtrl.create({message:"Logout successfull",duration:3e3})).present()})).catch(e=>(0,r.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e,duration:3e3})).present()}))}datePick1(e){this.excelIconDisable=null==this.myDate1||null==this.myDate2}datePick2(e){this.excelIconDisable=null==this.myDate1||null==this.myDate2}getDateTimeIn(e){return new Date(e).getTime()}getDateTimeOut(e){return new Date(e).getTime()}exportToExcel(){this.getApprCheckLists()}getApprCheckListsItems(e){this.itemsTemp=[];var t="",i="";c.Z.firestore().collection("checkListItems").where("checklistId","==",e).get().then(e=>{e.forEach(e=>{this.itemsTemp=e.data().items}),this.itemsTemp.forEach(e=>{1==e.checked&&(t=e.cleaningItemEn,i="Ok"),1==e.notApplicable&&(t=e.cleaningItemEn,i="Not Applicable"),this.checkListItems.push({CleaningItem:t,ItemComment:i})})})}getApprCheckLists(){this.items=[],c.Z.firestore().collection("checkList").where("checkListStatus","==","approved").get().then(e=>{e.forEach(e=>(0,r.__awaiter)(this,void 0,void 0,function*(){this.getApprCheckListsItems(e.id),e.data().timeRef>=this.getDateTimeIn(this.myDate1)&&e.data().timeRef<=this.getDateTimeOut(this.myDate2)?c.Z.firestore().collection("employee").where("Email","==",e.data().updatedBy).get().then(t=>{t.forEach(t=>{this.checkListItems.forEach(i=>(0,r.__awaiter)(this,void 0,void 0,function*(){this.items.push({Area:e.data().area,Description:e.data().areaName,Status:e.data().checkListStatus,DateTime:new Date(1e3*e.data().created.seconds),Employee:e.data().owner_name,ApprovedBy:t.data().Name+" "+t.data().LastName+" "+t.data().SecondLastName,ApprovedOn:new Date(1e3*e.data().updatedOn.seconds),CleaningItem:i.CleaningItem,Checked:i.ItemComment})}))})}).then(()=>{this.printToExcel()}).catch(e=>(0,r.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e.message,duration:3e3})).present()})):(yield this.toastCtrl.create({message:"There are no items within selected time range",duration:3e3})).present()}))}).then(()=>{}).catch(e=>(0,r.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e.message,duration:3e3})).present()}))}printToExcel(){this.data.exportToExcel(this.items,"CheckLists")}getApprover(e){c.Z.firestore().collection("employee").where("Email","==",e).get().then(e=>{e.forEach(e=>{this.empName=e.data().Name+" "+e.data().LastName+" "+e.data().SecondLastName})}).then(()=>{}).catch(e=>(0,r.__awaiter)(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e.message,duration:3e3})).present()}))}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(h.B),l.Y36(o.yF),l.Y36(o.HT),l.Y36(s.F0),l.Y36(g.L),l.Y36(d.$),l.Y36(o.SH))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-final-checklist-report"]],decls:26,vars:5,consts:[["color","danger"],[1,"lblHeading"],["slot","start"],["block","","clear","","color","Light","icon-only","",1,"backButton",3,"routerLink"],["name","arrow-back-outline",1,"backArrow"],["slot","end"],["icon-only","","clear","",1,"logoutBtn",3,"click"],["name","log-out",1,"lgIcon"],[1,"filterTitle"],[1,"titleLabel"],[1,"filterField"],[1,"fieldLabel"],["displayFormat","MMM DD, YYYY HH:mm","placeholder","Select Date 1",1,"dt",3,"ngModel","ngModelChange","ionChange"],["displayFormat","MMM DD, YYYY HH:mm","placeholder","Select Date 2",1,"dt",3,"ngModel","ngModelChange","ionChange"],[1,"filterBtn"],["src","../../assets/icon/microsoft-excel.ico",1,"imgC",3,"hidden","click"]],template:function(e,t){1&e&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar",0),l.TgZ(2,"ion-title"),l.TgZ(3,"ion-label",1),l._uU(4,"FinalChecklistReport"),l.qZA(),l.qZA(),l.TgZ(5,"ion-buttons",2),l.TgZ(6,"ion-button",3),l._UZ(7,"ion-icon",4),l.qZA(),l.qZA(),l.TgZ(8,"ion-buttons",5),l.TgZ(9,"ion-button",6),l.NdJ("click",function(){return t.Logout()}),l._UZ(10,"ion-icon",7),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(11,"ion-content"),l.TgZ(12,"ion-grid"),l.TgZ(13,"ion-row",8),l.TgZ(14,"ion-label",9),l._uU(15,"Filtered Report"),l.qZA(),l.qZA(),l.TgZ(16,"ion-row",10),l.TgZ(17,"ion-label",11),l._uU(18,"Start:"),l.qZA(),l.TgZ(19,"ion-datetime",12),l.NdJ("ngModelChange",function(e){return t.myDate1=e})("ionChange",function(e){return t.datePick1(e)}),l.qZA(),l.qZA(),l.TgZ(20,"ion-row",10),l.TgZ(21,"ion-label",11),l._uU(22,"End:"),l.qZA(),l.TgZ(23,"ion-datetime",13),l.NdJ("ngModelChange",function(e){return t.myDate2=e})("ionChange",function(e){return t.datePick2(e)}),l.qZA(),l.qZA(),l.TgZ(24,"ion-row",14),l.TgZ(25,"img",15),l.NdJ("click",function(){return t.exportToExcel()}),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.xp6(6),l.Q6J("routerLink",l.DdM(4,m)),l.xp6(13),l.Q6J("ngModel",t.myDate1),l.xp6(4),l.Q6J("ngModel",t.myDate2),l.xp6(2),l.Q6J("hidden",t.excelIconDisable))},directives:[o.Gu,o.sr,o.wd,o.Q$,o.Sm,o.YG,o.YI,s.rH,o.gu,o.W2,o.jY,o.Nd,o.x4,o.QI,a.JJ,a.On],styles:[".backArrow[_ngcontent-%COMP%]{color:#fff}.filterTitle[_ngcontent-%COMP%]{background-color:grey;text-align:center;color:#000;height:50px}.titleLabel[_ngcontent-%COMP%]{font-size:large;margin:auto}.filterField[_ngcontent-%COMP%]{background-color:blue;color:#faebd7;height:50px}.dt[_ngcontent-%COMP%], .fieldLabel[_ngcontent-%COMP%]{font-size:large}.dt[_ngcontent-%COMP%]{margin:auto}.filterBtn[_ngcontent-%COMP%]{background-color:blue;height:100px}.imgC[_ngcontent-%COMP%]{font-size:large;margin:auto;height:50px;width:50px}"]}),e})()}];let p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[s.Bz.forChild(u)],s.Bz]}),e})(),f=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[n.ez,a.u5,o.Pc,p]]}),e})()}}]);